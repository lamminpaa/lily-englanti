<!DOCTYPE html>
<html lang="fi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Englantipeli - Opi englantia hauskasti!</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="game-container">
        <header>
            <h1>ğŸ® Englantipeli ğŸ®</h1>
            <div class="score-board">
                <span class="score">Pisteet: <span id="score">0</span></span>
                <span class="streak">Putki: <span id="streak">0</span></span>
            </div>
        </header>

        <div id="menu-screen" class="screen active">
            <h2>ğŸ—ºï¸ Oppimispolku</h2>
            
            <div class="custom-exam-section">
                <button class="exam-btn" id="exam-camera-btn">
                    ğŸ“¸ Luo koe kuvasta
                </button>
                <p class="exam-description">Ota kuva kokeiden sanalistasta ja luo oma oppimispolku!</p>
            </div>
            
            <div class="learning-path">
                <div class="topic-tier" id="basic-tier">
                    <h3>ğŸŒŸ Perusteet</h3>
                    <p>Aloita tÃ¤Ã¤ltÃ¤ - nÃ¤mÃ¤ aiheet ovat aina saatavilla</p>
                    <div class="topic-grid">
                        <button class="topic-btn" data-topic="animals" data-tier="basic">
                            <div class="topic-content">
                                <div class="topic-icon">ğŸ¾</div>
                                <div class="topic-name">ElÃ¤imet</div>
                                <div class="topic-progress-bar">
                                    <div class="topic-progress-fill" id="progress-animals"></div>
                                </div>
                                <div class="topic-progress-text" id="progress-text-animals">0%</div>
                            </div>
                        </button>
                        <button class="topic-btn" data-topic="colors" data-tier="basic">
                            <div class="topic-content">
                                <div class="topic-icon">ğŸ¨</div>
                                <div class="topic-name">VÃ¤rit</div>
                                <div class="topic-progress-bar">
                                    <div class="topic-progress-fill" id="progress-colors"></div>
                                </div>
                                <div class="topic-progress-text" id="progress-text-colors">0%</div>
                            </div>
                        </button>
                        <button class="topic-btn" data-topic="numbers" data-tier="basic">
                            <div class="topic-content">
                                <div class="topic-icon">ğŸ”¢</div>
                                <div class="topic-name">Numerot</div>
                                <div class="topic-progress-bar">
                                    <div class="topic-progress-fill" id="progress-numbers"></div>
                                </div>
                                <div class="topic-progress-text" id="progress-text-numbers">0%</div>
                            </div>
                        </button>
                    </div>
                </div>
                
                <div class="topic-tier" id="intermediate-tier">
                    <h3>ğŸš€ Keskitaso</h3>
                    <p class="tier-requirement">Avautuu kun perusteet 50% valmiina</p>
                    <div class="topic-grid">
                        <button class="topic-btn" data-topic="food" data-tier="intermediate">
                            <div class="topic-content">
                                <div class="topic-icon">ğŸ</div>
                                <div class="topic-name">Ruoka</div>
                                <div class="topic-progress-bar">
                                    <div class="topic-progress-fill" id="progress-food"></div>
                                </div>
                                <div class="topic-progress-text" id="progress-text-food">0%</div>
                            </div>
                        </button>
                        <button class="topic-btn" data-topic="family" data-tier="intermediate">
                            <div class="topic-content">
                                <div class="topic-icon">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦</div>
                                <div class="topic-name">Perhe</div>
                                <div class="topic-progress-bar">
                                    <div class="topic-progress-fill" id="progress-family"></div>
                                </div>
                                <div class="topic-progress-text" id="progress-text-family">0%</div>
                            </div>
                        </button>
                    </div>
                </div>
                
                <div class="topic-tier" id="advanced-tier">
                    <h3>ğŸ† Edistynyt</h3>
                    <p class="tier-requirement">Avautuu kun keskitaso 70% valmiina</p>
                    <div class="topic-grid">
                        <button class="topic-btn" data-topic="school" data-tier="advanced">
                            <div class="topic-content">
                                <div class="topic-icon">ğŸ“š</div>
                                <div class="topic-name">Koulu</div>
                                <div class="topic-progress-bar">
                                    <div class="topic-progress-fill" id="progress-school"></div>
                                </div>
                                <div class="topic-progress-text" id="progress-text-school">0%</div>
                            </div>
                        </button>
                        <button class="topic-btn" data-topic="body" data-tier="advanced">
                            <div class="topic-content">
                                <div class="topic-icon">ğŸ‘¤</div>
                                <div class="topic-name">Keho</div>
                                <div class="topic-progress-bar">
                                    <div class="topic-progress-fill" id="progress-body"></div>
                                </div>
                                <div class="topic-progress-text" id="progress-text-body">0%</div>
                            </div>
                        </button>
                        <button class="topic-btn" data-topic="clothes" data-tier="advanced">
                            <div class="topic-content">
                                <div class="topic-icon">ğŸ‘•</div>
                                <div class="topic-name">Vaatteet</div>
                                <div class="topic-progress-bar">
                                    <div class="topic-progress-fill" id="progress-clothes"></div>
                                </div>
                                <div class="topic-progress-text" id="progress-text-clothes">0%</div>
                            </div>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <div id="mode-screen" class="screen">
            <nav class="breadcrumb">
                <span class="breadcrumb-item" id="breadcrumb-home">ğŸ  PÃ¤Ã¤valikko</span>
                <span class="breadcrumb-separator">â€º</span>
                <span class="breadcrumb-item current" id="breadcrumb-topic">ğŸ¯ <span id="current-topic-name"></span></span>
            </nav>
            <h2>ğŸ¯ Harjoituspolku: <span id="current-topic-name-title"></span></h2>
            
            <div class="game-modes-path">
                <div class="mode-step" data-step="1">
                    <div class="step-number">1</div>
                    <div class="mode-card learn-card available">
                        <div class="mode-icon">ğŸ“š</div>
                        <h3>Opettele uudet sanat</h3>
                        <p>Aloita tÃ¤stÃ¤ - opi sanat ensin rauhassa.</p>
                        <div class="progress-indicator">
                            <div class="progress-bar-mini">
                                <div class="progress-fill-mini" id="learn-progress"></div>
                            </div>
                            <span class="progress-text" id="learn-progress-text">0%</span>
                        </div>
                        <button class="mode-btn primary-btn" data-gamemode="learn">
                            Aloita oppiminen
                        </button>
                    </div>
                </div>
                
                <div class="mode-step" data-step="2">
                    <div class="step-number">2</div>
                    <div class="mode-card choice-card" id="choice-card">
                        <div class="mode-icon">ğŸ¯</div>
                        <h3>Monivalinta</h3>
                        <p>Helpoin testi - tunnista oikea vastaus neljÃ¤stÃ¤ vaihtoehdosta.</p>
                        <div class="unlock-requirement" id="choice-requirement">
                            ğŸ”’ Avautuu kun oppiminen 30% valmis
                        </div>
                        <div class="progress-indicator hidden">
                            <div class="progress-bar-mini">
                                <div class="progress-fill-mini" id="choice-progress"></div>
                            </div>
                            <span class="progress-text" id="choice-progress-text">0%</span>
                        </div>
                        <button class="mode-btn third-btn" data-gamemode="choice" disabled>
                            Aloita testi
                        </button>
                    </div>
                </div>
                
                <div class="mode-step" data-step="3">
                    <div class="step-number">3</div>
                    <div class="mode-card practice-card" id="practice-card">
                        <div class="mode-icon">âœï¸</div>
                        <h3>Kirjoitusharjoitus</h3>
                        <p>Haastavampaa - kirjoita tai sano sana omin sanoin.</p>
                        <div class="unlock-requirement" id="practice-requirement">
                            ğŸ”’ Avautuu kun monivalinta 50% valmis
                        </div>
                        <div class="progress-indicator hidden">
                            <div class="progress-bar-mini">
                                <div class="progress-fill-mini" id="practice-progress"></div>
                            </div>
                            <span class="progress-text" id="practice-progress-text">0%</span>
                        </div>
                        <button class="mode-btn secondary-btn" data-gamemode="practice" disabled>
                            Aloita harjoittelu
                        </button>
                    </div>
                </div>
                
                <div class="mode-step" data-step="4">
                    <div class="step-number">4</div>
                    <div class="mode-card listen-card" id="listen-card">
                        <div class="mode-icon">ğŸ‘‚</div>
                        <h3>Kuunteluharjoitus</h3>
                        <p>Haasta itsesi kuuntelulla - vaikein taso!</p>
                        <div class="unlock-requirement" id="listen-requirement">
                            ğŸ”’ Avautuu kun monivalinta 70% valmis
                        </div>
                        <div class="progress-indicator hidden">
                            <div class="progress-bar-mini">
                                <div class="progress-fill-mini" id="listen-progress"></div>
                            </div>
                            <span class="progress-text" id="listen-progress-text">0%</span>
                        </div>
                        <button class="mode-btn fourth-btn" data-gamemode="listen" disabled>
                            Aloita kuuntelu
                        </button>
                    </div>
                </div>
            </div>
            <div class="progress-info">
                <h4>Edistymisesi: <span id="topic-progress">0</span>%</h4>
                <div class="progress-bar">
                    <div class="progress-fill" id="progress-fill"></div>
                </div>
                <div class="mastery-stats" id="mastery-stats" style="margin-top: 15px;">
                    <div class="mastery-breakdown">
                        <div class="mastery-item">
                            <span class="mastery-icon">ğŸŒŸ</span>
                            <span class="mastery-count" id="mastered-count">0</span>
                            <span class="mastery-label">Mestari</span>
                        </div>
                        <div class="mastery-item">
                            <span class="mastery-icon">ğŸ†</span>
                            <span class="mastery-count" id="expert-count">0</span>
                            <span class="mastery-label">Asiantuntija</span>
                        </div>
                        <div class="mastery-item">
                            <span class="mastery-icon">ğŸ’ª</span>
                            <span class="mastery-count" id="strong-count">0</span>
                            <span class="mastery-label">Vahva</span>
                        </div>
                        <div class="mastery-item">
                            <span class="mastery-icon">ğŸ‘</span>
                            <span class="mastery-count" id="good-count">0</span>
                            <span class="mastery-label">HyvÃ¤</span>
                        </div>
                        <div class="mastery-item">
                            <span class="mastery-icon">ğŸ“š</span>
                            <span class="mastery-count" id="learning-count">0</span>
                            <span class="mastery-label">Oppii</span>
                        </div>
                        <div class="mastery-item">
                            <span class="mastery-icon">ğŸŒ±</span>
                            <span class="mastery-count" id="rookie-count">0</span>
                            <span class="mastery-label">Aloittelija</span>
                        </div>
                    </div>
                </div>
            </div>
            <button class="back-btn" id="back-to-menu">ğŸ  Takaisin pÃ¤Ã¤valikkoon</button>
        </div>

        <div id="game-screen" class="screen">
            <nav class="breadcrumb">
                <span class="breadcrumb-item clickable" id="breadcrumb-game-home">ğŸ  PÃ¤Ã¤valikko</span>
                <span class="breadcrumb-separator">â€º</span>
                <span class="breadcrumb-item clickable" id="breadcrumb-game-topic">ğŸ¯ <span id="game-topic-name"></span></span>
                <span class="breadcrumb-separator">â€º</span>
                <span class="breadcrumb-item current" id="breadcrumb-game-mode">ğŸ“ <span id="game-mode-name"></span></span>
            </nav>
            <div class="game-area">
                <div class="word-display">
                    <div class="finnish-word" id="finnish-word"></div>
                    <div class="word-image" id="word-image"></div>
                </div>

                <div id="learn-area" class="input-area" style="display: none;">
                    <div class="learn-content">
                        <div class="word-showcase">
                            <div class="word-card">
                                <div class="english-word-large" id="english-word-display"></div>
                                <div class="pronunciation-section">
                                    <button class="listen-btn" id="listen-word">
                                        ğŸ”Š Kuuntele Ã¤Ã¤ntÃ¤minen
                                    </button>
                                    <div class="phonetic" id="phonetic-text"></div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="learning-activities">
                            <div class="activity-section">
                                <h4>ğŸ’¡ Oppimistip</h4>
                                <div class="learn-tip" id="learn-tip"></div>
                            </div>
                            
                            <div class="activity-section">
                                <h4>ğŸ“ Esimerkkilause</h4>
                                <div class="example-sentence" id="example-sentence">
                                    <div class="sentence-text" id="sentence-text"></div>
                                    <button class="sentence-audio-btn" id="listen-sentence">
                                        ğŸ”Š Kuuntele lause
                                    </button>
                                </div>
                            </div>
                            
                            <div class="activity-section">
                                <h4>ğŸ¯ Harjoittele Ã¤Ã¤ntÃ¤mistÃ¤</h4>
                                <div class="pronunciation-practice">
                                    <button class="practice-pronunciation-btn" id="practice-pronunciation">
                                        ğŸ¤ Sano sana Ã¤Ã¤neen
                                    </button>
                                    <div class="pronunciation-feedback" id="pronunciation-feedback"></div>
                                </div>
                            </div>
                            
                            <div class="activity-section">
                                <h4>ğŸ”— Muista helpommin</h4>
                                <div class="memory-aid" id="memory-aid"></div>
                            </div>
                        </div>
                        
                        <div class="learn-actions">
                            <button class="got-it-btn" id="got-it">âœ… YmmÃ¤rsin! Seuraava sana</button>
                            <button class="repeat-btn" id="repeat-word">ğŸ”„ Kuuntele uudelleen</button>
                        </div>
                    </div>
                </div>

                <div id="practice-area" class="input-area" style="display: none;">
                    <div class="practice-mode-selector">
                        <button class="mode-toggle active" id="write-toggle">âœï¸ Kirjoita</button>
                        <button class="mode-toggle" id="speak-toggle">ğŸ¤ Puhu</button>
                    </div>
                    
                    <div id="write-practice" class="practice-method">
                        <input type="text" id="answer-input" placeholder="Kirjoita sana englanniksi">
                        <button class="submit-btn" id="submit-answer">Tarkista</button>
                    </div>
                    
                    <div id="speak-practice" class="practice-method" style="display: none;">
                        <div class="microphone-visual" id="microphone-visual" style="display: none;">
                            <div class="microphone-icon" id="microphone-icon">ğŸ¤</div>
                            <div class="volume-bars" id="volume-bars">
                                <div class="volume-bar"></div>
                                <div class="volume-bar"></div>
                                <div class="volume-bar"></div>
                                <div class="volume-bar"></div>
                                <div class="volume-bar"></div>
                                <div class="volume-bar"></div>
                                <div class="volume-bar"></div>
                            </div>
                        </div>
                        <button class="speak-btn" id="start-speaking">
                            ğŸ¤ Paina ja sano sana englanniksi
                        </button>
                        <div class="speech-tip" id="speech-tip" style="display: none;">
                            ğŸ’¡ Vinkki: Sano sana selkeÃ¤sti ja rauhallisesti mikrofoniin
                        </div>
                        <div class="speech-feedback" id="speech-feedback"></div>
                    </div>
                </div>

                <div id="choice-area" class="input-area" style="display: none;">
                    <div class="choices" id="choices">
                        <button class="choice-btn" data-choice="0"></button>
                        <button class="choice-btn" data-choice="1"></button>
                        <button class="choice-btn" data-choice="2"></button>
                        <button class="choice-btn" data-choice="3"></button>
                    </div>
                </div>

                <div id="listen-area" class="input-area" style="display: none;">
                    <div class="listen-controls">
                        <button class="listen-word-btn" id="listen-word-again">
                            ğŸ”Š Kuuntele uudelleen
                        </button>
                        <div class="listen-hint" id="listen-hint">
                            ğŸ’¡ Kuuntele sana huolellisesti ja valitse oikea suomenkielinen kÃ¤Ã¤nnÃ¶s
                        </div>
                    </div>
                    <div class="choices" id="listen-choices">
                        <button class="choice-btn" data-choice="0"></button>
                        <button class="choice-btn" data-choice="1"></button>
                        <button class="choice-btn" data-choice="2"></button>
                        <button class="choice-btn" data-choice="3"></button>
                    </div>
                </div>

                <div class="feedback" id="feedback"></div>
                <button class="next-btn" id="next-word" style="display: none;">Seuraava sana â†’</button>
            </div>
            <div class="game-navigation">
                <button class="back-btn" id="back-to-mode">â† Takaisin harjoituksiin</button>
                <button class="home-btn" id="home-from-game">ğŸ  PÃ¤Ã¤valikko</button>
            </div>
        </div>

        <div id="results-screen" class="screen">
            <nav class="breadcrumb">
                <span class="breadcrumb-item clickable" id="breadcrumb-results-home">ğŸ  PÃ¤Ã¤valikko</span>
                <span class="breadcrumb-separator">â€º</span>
                <span class="breadcrumb-item clickable" id="breadcrumb-results-topic">ğŸ¯ <span id="results-topic-name"></span></span>
                <span class="breadcrumb-separator">â€º</span>
                <span class="breadcrumb-item current">ğŸ‰ Tulokset</span>
            </nav>
            <h2>Hienoa! ğŸ‰</h2>
            <div class="results">
                <p class="final-score">Sait <span id="final-score">0</span> pistettÃ¤!</p>
                <p class="message" id="result-message"></p>
                <div class="star-rating" id="star-rating"></div>
            </div>
            <div class="results-navigation">
                <button class="play-again-btn" id="play-again">ğŸ”„ Pelaa sama uudelleen</button>
                <button class="try-different-btn" id="try-different-mode">ğŸ¯ Kokeile toista harjoitusta</button>
                <button class="back-btn" id="back-to-menu-from-results">ğŸ  Takaisin pÃ¤Ã¤valikkoon</button>
            </div>
        </div>
        
        <!-- Kuvan ottamis- ja parsintamodaali -->
        <div id="exam-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>ğŸ“¸ Luo koe kuvasta</h3>
                    <span class="close" id="close-exam-modal">&times;</span>
                </div>
                
                <div class="modal-body">
                    <div class="exam-step" id="step-capture">
                        <h4>1. Ota kuva sanalistasta</h4>
                        <p>Ota kuva kokeiden sanalistasta. AI tunnistaa sanat ja kÃ¤Ã¤nnÃ¶kset automaattisesti.</p>
                        
                        <div class="camera-container">
                            <input type="file" id="image-input" accept="image/*" capture="camera" style="display: none;">
                            <button class="camera-btn" id="take-photo-btn">
                                ğŸ“· Ota kuva
                            </button>
                            <button class="upload-btn" id="upload-photo-btn">
                                ğŸ“ Valitse tiedosto
                            </button>
                        </div>
                        
                        <div class="image-preview" id="image-preview" style="display: none;">
                            <img id="preview-image" alt="Kuvan esikatselu">
                            <button class="analyze-btn" id="analyze-image-btn">
                                ğŸ¤– Analysoi kuva
                            </button>
                        </div>
                    </div>
                    
                    <div class="exam-step" id="step-processing" style="display: none;">
                        <h4>2. Analysoidaan kuvaa...</h4>
                        <div class="loading-spinner">
                            <div class="spinner"></div>
                            <p>AI tunnistaa sanoja ja kÃ¤Ã¤nnÃ¶ksiÃ¤...</p>
                        </div>
                    </div>
                    
                    <div class="exam-step" id="step-results" style="display: none;">
                        <h4>3. Tunnistetut sanat</h4>
                        <p>Tarkista ja muokkaa tarvittaessa:</p>
                        
                        <div class="words-list" id="detected-words-list">
                            <!-- TÃ¤hÃ¤n tulee tunnistetut sanat -->
                        </div>
                        
                        <div class="exam-options">
                            <label for="exam-name-input">Kokeen nimi:</label>
                            <input type="text" id="exam-name-input" placeholder="Esim. Lukion koe 3" maxlength="50">
                            
                            <button class="create-exam-btn" id="create-exam-btn">
                                ğŸ¯ Luo oppimispolku
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- OCR Libraries -->
    <script src="https://unpkg.com/tesseract.js@v2.1.5/dist/tesseract.min.js"></script>
    
    <script src="words.js"></script>
    <script src="progress.js"></script>
    <script src="game.js"></script>
</body>
</html>